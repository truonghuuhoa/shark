!function(o,t){var l={cache:function(){l.els={},l.vars={},l.vars.u_hide_class="fcms-was-u-hide",l.els.attribute_form=o(".product_page_product_attributes #attribute_label").closest("form"),l.els.attribute_form_submit=l.els.attribute_form.find(".submit"),l.els.product_attribute_swatch_types=o(".fcms-was-attributes__swatch-type select"),l.els.attribute_type_field=o('select[name="attribute_type"]')},on_ready:function(){l.cache(),l.setup_attribute_fields(),l.setup_product_swatch_fields()},setup_attribute_fields:function(){l.get_attribute_fields(function(t){t=l.format_attribute_fields(t);l.els.attribute_form_submit.before(t),o("[data-conditional]").fcmsConditional()}),l.els.attribute_type_field.on("change",function(){var t=o(this).val(),i=o(".fcms-was-attribute-fields");"select"===t?i.removeClass(l.vars.u_hide_class):i.addClass(l.vars.u_hide_class)}),l.setup_colour_pickers(),l.setup_image_swatch_fields()},setup_colour_pickers:function(){o(".colour-swatch-picker").wpColorPicker()},setup_image_swatch_fields:function(){var s;o(".fcms-was-image-picker__upload").on("click",function(t){t.preventDefault();var i=o(this),t=i.closest(".fcms-was-image-picker"),e=t.find(".fcms-was-image-picker__field"),a=t.find(".fcms-was-image-picker__preview"),c=t.find(".fcms-was-image-picker__remove");(s=wp.media.frames.file_frame=wp.media({title:o(this).data("title"),button:{text:o(this).data("button-text")},multiple:!1})).on("select",function(){attachment=s.state().get("selection").first().toJSON(),attachment_url=(void 0!==attachment.sizes.thumbnail?attachment.sizes.thumbnail:attachment).url,e.val(attachment.id),a.html('<img src="'+attachment_url+'" class="attachment-thumbnail size-thumbnail">'),i.addClass("fcms-was-image-picker__upload--edit"),c.show()}),s.open()}),o(".fcms-was-image-picker__remove").on("click",function(t){t.preventDefault();var i=o(this).closest(".fcms-was-image-picker"),e=i.find(".fcms-was-image-picker__field"),t=i.find(".fcms-was-image-picker__preview"),i=i.find(".fcms-was-image-picker__upload");e.val(""),t.html(""),i.removeClass("fcms-was-image-picker__upload--edit"),o(this).hide()})},get_admin_page:function(){return!(l.els.attribute_form.length<=0)&&(0<l.els.attribute_form.find("table").length?"update":"add")},get_attribute_fields:function(i){var t={action:"fcms_was_get_attribute_fields",attribute_id:void 0!==fcms_was_vars.url_params.edit&&fcms_was_vars.url_params.edit};o.post(ajaxurl,t,function(t){return!0===t.success&&void(i&&"function"==typeof i&&i(t.fields))})},format_attribute_fields:function(t){var i,r,s,e="text"===l.els.attribute_type_field.val()?l.vars.u_hide_class:"";return"update"===l.get_admin_page()?(i=o("<table />"),r=o("<tbody />"),i.attr("class","form-table fcms-was-attribute-fields "+e),o.each(t,function(t,i){var e=!!i.condition&&(o.isArray(i.condition)?JSON.stringify(i.condition):i.condition),a=JSON.stringify(i.match),c=o("<tr />"),s=o('<th scope="row" valign="top" />'),n=o("<td />");c.attr("class","fcms-was-attribute-row form-field "+i.class.join(" ")),e&&(c.attr("data-condition",e),c.attr("data-match",a)),s.append('<label for="'+t+'">'+i.label+"</label>"),n.append(i.field+'<p class="description">'+i.description+"</p>"),c.append(s,n),r.append(c)}),i.append(r)):((s=o("<div />")).attr("class","fcms-was-attribute-fields "+e),o.each(t,function(t,i){var e=!!i.condition&&(o.isArray(i.condition)?JSON.stringify(i.condition):i.condition),a=JSON.stringify(i.match),c=o("<div />");c.attr("class","fcms-was-attribute-row form-field "+i.class.join(" ")),e&&(c.attr("data-condition",e),c.attr("data-match",a)),c.append('<label for="'+t+'">'+i.label+"</label>"),c.append(i.field+'<p class="description">'+i.description+"</p>"),s.append(c)}),s)},escape:function(t){return t.replace(/[\\]/g,"\\\\").replace(/[\"]/g,"&quot;").replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")},setup_product_swatch_fields:function(){l.els.product_attribute_swatch_types.on("change",function(){var t=o(this),i=t.val(),e=t.find(":selected").text(),a=t.closest(".fcms-was-attribute-wrapper"),c=a.find(".fcms-was-swatch-type"),s=a.find(".fcms-was-attributes__swatch-options td"),n=parseInt(a.data("product-id")),t=a.data("taxonomy"),r=a.find(".wc-metabox-content");c.text(e),s.html(""),l.reset_height(r),l.is_swatch_visual(i)&&(t={action:"fcms_was_get_product_attribute_fields",swatch_type:i,product_id:n,attribute_slug:t},o.post(ajaxurl,t,function(t){return!0===t.success&&(!1!==t.fields&&(s.html(t.fields),l.setup_image_swatch_fields(),l.setup_colour_pickers(),void l.reset_height(r)))}))})},is_swatch_visual:function(t){return"colour-swatch"===t||"image-swatch"===t},reset_height:function(t){t.height("")}};o(t).ready(l.on_ready())}(jQuery,document);